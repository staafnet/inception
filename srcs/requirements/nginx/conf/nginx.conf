events {} # Blok events (wymagany przez nginx) - domyślne ustawienia połączeń

http { # Blok HTTP - główna konfiguracja web servera
    include /etc/nginx/mime.types; # Ładuje typy MIME (text/html, image/png, etc.)

    server { # Wirtualny host (vhost)
        listen 443 ssl; # Nasłuchuje na porcie 443 z SSL (HTTPS)
        server_name rgrochow.42.fr; # Nazwa domeny dla tego vhosta

        ssl_certificate /etc/nginx/ssl/nginx.crt; # Ścieżka do certyfikatu SSL (publiczny)
        ssl_certificate_key /etc/nginx/ssl/nginx.key; # Ścieżka do klucza prywatnego
        ssl_protocols TLSv1.2 TLSv1.3; # Dozwolone protokoły SSL/TLS (wymagane przez PDF)

        root /var/www/html; # Główny katalog strony (bind mount z WordPress)
        index index.php; # Plik główny (WordPress router)

        location / { # Obsługa wszystkich requestów
            try_files $uri $uri/ /index.php?$args; # Sprawdza plik → katalog → przekazuje do WordPress
        }

        location ~ \.php$ { # Obsługa plików PHP (regex: kończy się na .php)
            include snippets/fastcgi-php.conf; # Ładuje konfigurację FastCGI (bezpieczeństwo + PATH_INFO)
            fastcgi_pass wordpress:9000; # Przekazuje request do kontenera wordpress port 9000
            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; # Ścieżka do pliku PHP
            include fastcgi_params; # Ładuje standardowe parametry FastCGI
        }
    }
}
